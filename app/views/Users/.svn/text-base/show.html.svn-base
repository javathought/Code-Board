
#{extends 'main.html' /}
#{set 'title'}&{'application.title'}#{/set}


<div id="header">
	<h1>#{get 'title' /}</h1>
	<div id="main-menu">
	</div>
	
</div>


<div class="nosidebar" id="main">

    <div id="sidebar">        
        
    </div>
    
	<div id="content">    

		#{if user?.id}
		<h2><a href="/admin/users">Users</a> Â» ${user.login}</h2>
		#{/if}
		#{else}
		<h2>New User</h2>
		#{/else}
		
		#{ifErrors}
 
	   		<h1>Oops...</h1>
	 		<div class="errorExplanation" id="errorExplanation">
	 		<ul>
 
		   #{errors}
		       <li>${error}</li>
		   #{/errors}
 
 			</ul></div>
 
		#{/ifErrors}



		<div class="tabs">
		  	<ul>
		      	<li>
		      	<a href="/admin/users/${user?.login}" class="selected" id="tab-general" onclick="showTab('general'); this.blur(); return false;">
		      	General</a></li>
		      	<!-- li><a href="#" id="tab-memberships" onclick="showTab('memberships'); this.blur(); return false;">Projects</a></li -->
		    </ul>
		  	<div class="tabs-buttons" style="display:none;">
		  	<button class="tab-left" onclick="moveTabLeft(this);"></button>
		  	<button class="tab-right" onclick="moveTabRight(this);"></button>
		  	</div>
		</div>
	
	 	<div class="tab-content" id="tab-content-general">
		    #{form @Users.save(new_password, isAdmin), id:'form', method:'POST', enctype:'multipart/form-data'}
		    <input type="hidden" name="user.id" id="id" value="${user?.id}" />
		    <div class="box tabular">
				<p><label for="user_login">Login<span class="required"> *</span></label>
				<input id="user_login" name="user.login" size="25" type="text" value="${user?.login}" #{if user?.id} disabled #{/if}/>
				<span class="errorExplanation">#{error 'login' /}</span></p>
			
				<p><label for="user_firstname">Firstname<span class="required"> *</span></label>
				<input id="user_firstname" name="user.firstname" size="30" type="text" value="${user?.firstname}" />
				<span class="errorExplanation">#{error 'firstname' /}</span></p>
				<p><label for="user_lastname">Lastname<span class="required"> *</span></label>
				<input id="user_lastname" name="user.lastname" size="30" type="text" value="${user?.lastname}" />
				<span class="errorExplanation">#{error 'lastname' /}</span></p>
				<p><label for="user_mail">Email<span class="required"> *</span></label>
				<input id="user_mail" name="user.mail" size="30" type="text" value="${user?.mail}" />
				<span class="errorExplanation">#{error 'mail' /}</span></p>
				#{secure.check 'admin'}
				<p><label for="user_admin">Administrator</label>
				<input type="checkbox" id="user_admin" name="isAdmin"  #{if user?.admin }checked#{/if} />
				<span class="errorExplanation">#{error 'admin' /}</span></p>
				#{/secure.check }
		    </div>
			<div class="box tabular">
		    	<h3>Authentication</h3>

				<div id="password_fields" style="">
					<p><label for="user_password">Password<span class="required"> *</span></label>
					<input id="user_password" name="new_password" size="25" type="password" value=""/>
				<span class="errorExplanation">#{error 'hashed_password' /}</span><br />
					<em>Must be at least 4 characters long.</em></p>
				<p><label for="user_password_confirmation">Confirmation<span class="required"> *</span></label>
				<input id="user_password_confirmation" name="password_confirmation" size="25" type="password" /></p>

				</div>
		    </div>
	        <p class="crudButtons">
	            <input type="submit" name="_save" value="Save" />
	            <!-- input type="submit" name="_saveAndContinue" value="Save and Continue" / -->
	        </p>
		    #{/form}

		</div>
		<div class="tab-content" id="tab-content-memberships" style="display:none">
		</div>
		
	</div>	

</div>